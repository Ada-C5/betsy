<h1>This your order fulfillment page ðŸ’°</h1>

<!-- create_table "orders", force: :cascade do |t|
  t.string   "order_state", null: false
  t.integer  "user_id"
  t.integer  "total"
  t.datetime "created_at",  null: false
  t.datetime "updated_at",  null: false
end -->
<div class="panel panel-primary">
Your total Revenue including pending and cancel orders is <span class="input-group-addon" id="sizing-addon1"><%= @total_revenue %></span>
</div>

<div class="panel panel-default">
  <!-- Default panel contents -->
  <div class="panel-heading">Panel heading</div>


  <table class="table">
    <tr>
      <th>Status</th>
      <th>Revenue by Status</th>
      <th>Number of orders</th>

    </tr>
<% @grouped_by_status.each do |status, array| %>
<tr>
  <td><%= status.capitalize %></td>
  <td><%= array.map { |item| item.product.price }.sum %></td>
<td><span class="badge"><%= array.map { |item| item.order_id }.count %></span></td>
<%end%>

  </table>
</div>


<% states_for_select = @grouped_by_status.keys.map { |s| [s.capitalize, s] } %>
<%= form_tag user_orders_path, method: :get do %>
<%= select_tag(:order_state, options_for_select(states_for_select,
:selected => params[:order_state]), :prompt => "Filter orders by status") %>

<%= submit_tag "Submit" %>
<% end %>
<br><br>
<br><br>
<div class="row">
<% @orders.each do |order| %>
    <div class="col-sm-6 col-md-4">
      <div class="thumbnail">
  <div class="caption">
    <h3> Order id:<%= order.id %></h3>
    <br>
    <p> Buyer: <%= order.user.name%></p>
    <p> Products:<%= OrderItem.where(order_id: order.id).first.inspect%></p>

    <p><a href="#" class="btn btn-primary" role="button">See</a>

      </div>
    </div>
  </div>
  <% end %>
</div>
